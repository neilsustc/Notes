<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CUDA | Notes</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="Notes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="preload" href="/notes/assets/css/0.styles.d5c66c02.css" as="style"><link rel="preload" href="/notes/assets/js/app.5908c34b.js" as="script"><link rel="preload" href="/notes/assets/js/2.8f7a32b9.js" as="script"><link rel="preload" href="/notes/assets/js/8.58a33754.js" as="script"><link rel="prefetch" href="/notes/assets/js/10.f3499ffa.js"><link rel="prefetch" href="/notes/assets/js/11.2d199652.js"><link rel="prefetch" href="/notes/assets/js/12.c5d4e9c5.js"><link rel="prefetch" href="/notes/assets/js/13.1dd82421.js"><link rel="prefetch" href="/notes/assets/js/14.1f221fd5.js"><link rel="prefetch" href="/notes/assets/js/15.eeae3e55.js"><link rel="prefetch" href="/notes/assets/js/16.e5f82b75.js"><link rel="prefetch" href="/notes/assets/js/17.a1023502.js"><link rel="prefetch" href="/notes/assets/js/18.1e7d344f.js"><link rel="prefetch" href="/notes/assets/js/19.817da871.js"><link rel="prefetch" href="/notes/assets/js/20.a56e590a.js"><link rel="prefetch" href="/notes/assets/js/21.69534415.js"><link rel="prefetch" href="/notes/assets/js/22.09dfe03a.js"><link rel="prefetch" href="/notes/assets/js/23.caa92ca5.js"><link rel="prefetch" href="/notes/assets/js/24.818a85c4.js"><link rel="prefetch" href="/notes/assets/js/25.a58da66a.js"><link rel="prefetch" href="/notes/assets/js/26.af5935df.js"><link rel="prefetch" href="/notes/assets/js/27.b0333c44.js"><link rel="prefetch" href="/notes/assets/js/28.6503ddff.js"><link rel="prefetch" href="/notes/assets/js/29.4293f29b.js"><link rel="prefetch" href="/notes/assets/js/3.130d6c11.js"><link rel="prefetch" href="/notes/assets/js/30.551cbd5c.js"><link rel="prefetch" href="/notes/assets/js/31.85407732.js"><link rel="prefetch" href="/notes/assets/js/32.f1174215.js"><link rel="prefetch" href="/notes/assets/js/33.437157cd.js"><link rel="prefetch" href="/notes/assets/js/34.15542ecc.js"><link rel="prefetch" href="/notes/assets/js/35.f8f13fe4.js"><link rel="prefetch" href="/notes/assets/js/36.775aef30.js"><link rel="prefetch" href="/notes/assets/js/37.d6cb6d83.js"><link rel="prefetch" href="/notes/assets/js/38.5645d2e7.js"><link rel="prefetch" href="/notes/assets/js/39.cd531283.js"><link rel="prefetch" href="/notes/assets/js/4.6113757d.js"><link rel="prefetch" href="/notes/assets/js/40.44bffefa.js"><link rel="prefetch" href="/notes/assets/js/41.02f18ff7.js"><link rel="prefetch" href="/notes/assets/js/42.161f67cd.js"><link rel="prefetch" href="/notes/assets/js/43.c36d5119.js"><link rel="prefetch" href="/notes/assets/js/44.7f60bb75.js"><link rel="prefetch" href="/notes/assets/js/45.23ce4858.js"><link rel="prefetch" href="/notes/assets/js/46.a5dcb501.js"><link rel="prefetch" href="/notes/assets/js/47.13cf2ea9.js"><link rel="prefetch" href="/notes/assets/js/48.5db85305.js"><link rel="prefetch" href="/notes/assets/js/49.13def15e.js"><link rel="prefetch" href="/notes/assets/js/5.842f9796.js"><link rel="prefetch" href="/notes/assets/js/50.72c9fcc0.js"><link rel="prefetch" href="/notes/assets/js/51.ec409b6a.js"><link rel="prefetch" href="/notes/assets/js/52.3cf4fb83.js"><link rel="prefetch" href="/notes/assets/js/53.5a84cec3.js"><link rel="prefetch" href="/notes/assets/js/54.3e9cee12.js"><link rel="prefetch" href="/notes/assets/js/55.a0b90f45.js"><link rel="prefetch" href="/notes/assets/js/56.bbc5193f.js"><link rel="prefetch" href="/notes/assets/js/57.27caaed7.js"><link rel="prefetch" href="/notes/assets/js/58.2d2e7adc.js"><link rel="prefetch" href="/notes/assets/js/59.08b86018.js"><link rel="prefetch" href="/notes/assets/js/6.48da5f77.js"><link rel="prefetch" href="/notes/assets/js/7.de94f265.js"><link rel="prefetch" href="/notes/assets/js/9.86555e8a.js">
    <link rel="stylesheet" href="/notes/assets/css/0.styles.d5c66c02.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notes/software/" class="nav-link">
  Software and Tools
</a></div><div class="nav-item"><a href="/notes/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/notes/langs/" class="nav-link">
  Languages
</a></div><div class="nav-item"><a href="/notes/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/yzhang-gh/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notes/software/" class="nav-link">
  Software and Tools
</a></div><div class="nav-item"><a href="/notes/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/notes/langs/" class="nav-link">
  Languages
</a></div><div class="nav-item"><a href="/notes/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/yzhang-gh/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/programming/python/miniconda.html" class="sidebar-link">Miniconda</a></li><li><a href="/notes/programming/python/matplotlib.html" class="sidebar-link">Matplotlib</a></li><li><a href="/notes/programming/python/python.html" class="sidebar-link">Python</a></li><li><a href="/notes/programming/python/user-snippets.html" class="sidebar-link">常用代码片段</a></li><li><a href="/notes/programming/python/cuda.html" aria-current="page" class="active sidebar-link">CUDA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/programming/python/cuda.html#numba-简介" class="sidebar-link">Numba 简介</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/cuda.html#自定义-cuda-核函数" class="sidebar-link">自定义 CUDA 核函数</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/cuda.html#cuda-多维网格与共享内存" class="sidebar-link">CUDA 多维网格与共享内存</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/cuda.html#😎" class="sidebar-link">😎</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>LaTeX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/programming/latex.html" class="sidebar-link">LaTeX</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="加速计算基础──cuda-python-编程"><a href="#加速计算基础──cuda-python-编程" class="header-anchor">#</a> 加速计算基础──CUDA Python 编程</h1> <div class="callout"><p>💡　某程序员遇到了一个问题，打算用并行来解决它──现他在有个两问题了。</p></div> <p>本文大部分内容来自 NVIDIA Deep Learning Institute</p> <h2 id="numba-简介"><a href="#numba-简介" class="header-anchor">#</a> Numba 简介</h2> <blockquote><p>Numba 是一个<strong>支持类型特化</strong>的<strong>即时</strong> <strong>函数编译器</strong>，用于为 CPU 或 GPU 加速<strong>以数字计算为主的</strong> Python 函数。此定义很长，下面就让我们逐一解析这些术语：</p> <ul><li><strong>函数编译器</strong>：Numba 用于编译 Python 函数，而非整个应用程序，亦不定义函数。Numba 不会取代 Python 解释器，而仅作为另一个 Python 模块，将普通函数转化为执行速度更快的函数（通常情况下）。</li> <li><strong>类型特化</strong>：Numba 可为您当前使用的特定数据类型生成专门的执行代码，从而加速函数运行。Python 函数专为处理通用数据类型而设计，这为其带来了极大的灵活性，但也严重拖慢了运行速度。实际上，您只需调用具有少量参数类型的函数，即可让 Numba 为每个类型组生成快速执行代码。</li> <li><strong>即时</strong>：Numba 在函数首次被调用时即会开始编译函数。确保编译器了解您将使用的参数类型。此特性还支持在 Jupyter Notebook 中以交互方式使用 Numba，正如使用传统应用程序一样简单。</li> <li><strong>以数字计算为主</strong>：Numba 目前以处理基本数据类型为主，如 <code>int</code>、<code>float</code> 和 <code>complex</code>。字符串处理支持极为受限，且许多字符串处理函数还无法在 GPU 上获得有效加速。若要借助 Numba 获得最佳加速效果，您可能需要搭配使用 NumPy 数组。</li></ul></blockquote> <p>CUDA 编程方式包括</p> <ul><li><strong>CUDA C/C++</strong>（最高效、灵活）</li> <li><strong>PyCUDA</strong>（完全对接 CUDA C/C++，性能次佳，不过需编写 C 代码，通常还要修改 Python 代码）</li> <li><strong>Numba</strong>（Python 最友好，也能为 CPU 加速）</li></ul> <p><code>@jit</code> <code>@njit</code> 加速 CPU（实时编译成机器码）</p> <p><code>@vectorize</code>（GPU 并行，ufunc）</p> <div class="custom-block tip"><p class="custom-block-title">Best Practice</p> <p>尽量减少 CPU (Host) 和 GPU (Device) 间的数据传输，即便中途遇到在 GPU 上并不比在 CPU 上运行快的函数，也需遵照此规则</p> <p><a href="https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html" target="_blank" rel="noopener noreferrer">CUDA Best Practices Guide<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p><code>@cuda.jit</code></p> <p><code>cuda.to_device</code> <code>copy_to_host()</code></p> <h2 id="自定义-cuda-核函数"><a href="#自定义-cuda-核函数" class="header-anchor">#</a> 自定义 CUDA 核函数</h2> <h3 id="线程结构"><a href="#线程结构" class="header-anchor">#</a> 线程结构</h3> <ul><li><mark>Thread</mark>，GPU 工作的最小单元</li> <li><mark>Block</mark>，由多个 thread 组成，拥有<strong>共享内存</strong></li> <li><mark>Grid</mark>，由多个 block 组成，是 GPU 上的函数（即核函数）执行的单元</li></ul> <figure><img src="data:image/png;base64,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" alt="Grid of thread blocks" class="border"> <figcaption>Thread hierarchy. <a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#thread-hierarchy" target="_blank" rel="noopener noreferrer">source</a></figcaption></figure> <p><code>cuda.gird</code></p> <p><code>cuda.gridsize</code></p> <p>练习：使用网格跨度 (stride) 处理超大数据集</p> <h3 id="原子操作"><a href="#原子操作" class="header-anchor">#</a> 原子操作</h3> <p><code>cuda.atomic.*</code></p> <h2 id="cuda-多维网格与共享内存"><a href="#cuda-多维网格与共享内存" class="header-anchor">#</a> CUDA 多维网格与共享内存</h2> <p>练习：矩阵转置与矩阵乘法</p> <p>……</p> <h2 id="😎"><a href="#😎" class="header-anchor">#</a> 😎</h2> <figure><img src="/notes/assets/img/cuda-certificate.47c1a9b3.png" alt="cuda certificate" class="border"></figure></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last updated:</span> <span class="time">11/23/2020, 5:05:54 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/programming/python/user-snippets.html" class="prev">
        常用代码片段
      </a></span> <span class="next"><a href="/notes/programming/latex.html">
        LaTeX
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/notes/assets/js/app.5908c34b.js" defer></script><script src="/notes/assets/js/2.8f7a32b9.js" defer></script><script src="/notes/assets/js/8.58a33754.js" defer></script>
  </body>
</html>
